// Mochi Chat app
// Copyright Alistair Cunningham 2025

{
	"version": "2.12",
	"label": "app_name",
	"classes": ["chat"],
	"paths": ["chat"],
	"services": ["chat"],

	"architecture": {"engine": "starlark", "version": 4},
	"execute": ["chat.star"],

	"database": {
		"schema": 3,
		"file": "chat.db",
		"create": {"function": "database_create"},
		"upgrade": {"function": "database_upgrade"}
	},

	"icons": [
		{"action": "", "label": "app_name", "file": "images/icon.svg"}
	],

	"actions": {
		"": {"file": "web/dist/index.html"},
		"assets": {"files": "web/dist/assets"},
		"-/create": {"function": "action_create"},
		"images": {"files": "web/dist/images"},
		"-/list": {"function": "action_list"},
		"-/new": {"function": "action_new"},

		":chat": {"file": "web/dist/index.html"},
		":chat/-/view": {"function": "action_view"},
		":chat/-/messages": {"function": "action_messages"},
		":chat/-/send": {"function": "action_send"},
		":chat/-/members": {"function": "action_members"},
		":chat/-/rename": {"function": "action_rename"},
		":chat/-/leave": {"function": "action_leave"},
		":chat/-/delete": {"function": "action_delete"},
		":chat/-/member_add": {"function": "action_member_add"},
		":chat/-/member_remove": {"function": "action_member_remove"},
		":chat/-/attachments/:id": {"feature": "attachment"},
		":chat/-/attachments/:id/thumbnail": {"feature": "attachment/thumbnail"},
		":chat/settings": {"file": "web/dist/index.html"},
		":chat/settings/assets": {"files": "web/dist/assets"},
		":chat/settings/images": {"files": "web/dist/images"},
		":chat/assets": {"files": "web/dist/assets"},
		":chat/images": {"files": "web/dist/images"},
		"-/notifications/subscribe": {"function": "action_notifications_subscribe"},
		"-/notifications/check": {"function": "action_notifications_check"},
		"-/notifications/destinations": {"function": "action_notifications_destinations"}
	},

	"events": {
		"message": {"function": "event_message"},
		"new": {"function": "event_new"},
		"rename": {"function": "event_rename"},
		"leave": {"function": "event_leave"},
		"member_add": {"function": "event_member_add"},
		"member_remove": {"function": "event_member_remove"},
		"removed": {"function": "event_removed"}
	}
}
